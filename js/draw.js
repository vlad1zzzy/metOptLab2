const plot = document.getElementById('plotly');

export function drawGradient(x, y, func) {
    const xAns = Math.round(x[x.length - 1]);
    const yAns = Math.round(y[y.length - 1]);
    const size = 500, x_lvl = new Array(size), y_lvl = new Array(size), z_lvl = new Array(size);
    for (let i = 0; i < size; i++) {
        x_lvl[i] = 0.1 * i - 20 + xAns;
        y_lvl[i] = 0.1 * i - 20 + yAns;
        z_lvl[i] = new Array(size);
    }

    for (let i = 0; i < size; i++) {
        for (let j = 0; j < size; j++) {
            z_lvl[j][i] = func(x_lvl[i], y_lvl[j]);
        }
    }

    let trace1 = {
        x: x,
        y: y,
        mode: 'lines+markers',
        marker: {
            color: 'rgb(219, 64, 82)',
            size: 3
        }
    };

    let trace2 = {
        x: x_lvl,
        y: y_lvl,
        z: z_lvl,
        type: 'contour',
        colorscale: 'Jet',
        contours: {
            coloring: 'lines',
            start: 0,
            end: 10000,
            size: 500
        }
    }

    let data = [trace1, trace2];

    let layout = {
        title: "Gradient",
        showlegend: false,
        hovermode: 'closest',
        bargap: 0,
    };

    Plotly.newPlot(plot, data, layout);
}

const step = document.getElementById('step');
const great = document.getElementById('great');
const conjugate = document.getElementById('conjugate');

export function drawStepGradient() {
    const x = Array.from({length: 100}, (_, ind) => ind * 10);
    const n10 = [14, 28, 46, 65, 76, 91, 101, 120, 147, 148, 158, 178, 204, 219, 216, 253, 286,
        251, 261, 315, 316, 341, 349, 387, 396, 407, 418, 449, 438, 493, 462, 520, 484,
        506, 559, 524, 579, 623, 638, 693, 654, 593, 649, 628, 660, 680, 728, 756, 792,
        780, 690, 789, 923, 761, 763, 769, 850, 883, 967, 839, 980, 1000, 939, 1000]
    const n100 = [29, 31, 40, 58, 82, 95, 98, 115, 177, 146, 163, 171, 187, 224, 238, 200,
        245, 253, 273, 270, 290, 310, 325, 375, 363, 387, 377, 408, 437, 431, 445, 440, 485,
        490, 430, 521, 559, 561, 544, 561, 614, 605, 653, 601, 663, 677, 640, 704, 717, 747,
        739, 744, 754, 848, 772, 808, 826, 889, 857, 834, 856, 926, 962, 954, 947, 978, 956, 988, 992, 1000]
    const n1000 = [11, 25, 44, 59, 67, 84, 95, 111, 128, 147, 156, 170, 187, 191, 211, 220,
        249, 254, 275, 289, 290, 311, 300, 339, 361, 327, 388, 397, 413, 429, 440, 461, 470,
        484, 499, 520, 522, 548, 547, 579, 580, 599, 611, 635, 634, 654, 685, 697, 694, 748,
        728, 737, 769, 780, 708, 793, 816, 846, 848, 858, 875, 870, 913, 940, 937, 942, 964, 997, 981, 1000]
    const n10000 = [12, 25, 40, 54, 69, 83, 90, 111, 124, 149, 158, 170, 184, 190, 212, 227,
        247, 257, 269, 283, 293, 313, 328, 348, 353, 360, 388, 391, 413, 422, 441, 455, 467,
        485, 499, 511, 529, 542, 556, 571, 585, 580, 614, 628, 644, 662, 671, 681, 694, 717,
        730, 745, 753, 768, 782, 802, 815, 824, 846, 851, 806, 874, 906, 915, 995, 931, 951, 969, 983, 1000]


    let data = getData(n10, n100, n1000, n10000);

    let layout = {
        title: "Step gradient",
        showlegend: true,
        hovermode: 'closest',
        bargap: 0,
    };

    Plotly.newPlot(step, data, layout);
}

export function drawGreatGradient() {
    const n10 = [98, 196, 291, 387, 475, 579, 679, 777, 873, 963, 1063, 1167, 1265, 1355, 1409, 1545, 1619, 1739, 1851, 1935, 2040,
        2128, 2213, 2307, 2433, 2469, 2399, 2633, 2809, 2897, 2852, 3094, 3158, 3264, 3177, 3427, 3549, 3650, 3593, 3796, 3877, 4028,
        3923, 4203, 4322, 4407, 4428, 4413, 4495, 4842, 4888, 5025, 5021, 5165, 5315, 5189, 5372, 5492, 5610, 5462, 5919, 5913, 5914,
        6143, 5726, 6327, 6521, 6612, 6469, 6595, 6611, 6977, 6699, 6871, 7037, 7389, 7207, 7326, 7512, 7472, 7600, 7718, 7676, 7842,
        8043, 7959, 8414, 8445, 8326, 8468, 8510, 8911, 8940, 8703, 8675, 8978, 9131, 9388, 8829]
    const n100 = [97, 195, 293, 391, 479, 585, 677, 779, 867, 973, 1051, 1155, 1263, 1349, 1454, 1543, 1635, 1746, 1813, 1920, 2026,
        2133, 2216, 2319, 2405, 2478, 2597, 2665, 2806, 2877, 2981, 3105, 3151, 3260, 3376, 3458, 3483, 3646, 3722, 3828, 3949, 4060,
        4088, 4218, 4263, 4383, 4451, 4507, 4691, 4791, 4899, 4956, 5035, 5090, 5181, 5354, 5393, 5504, 5711, 5642, 5790, 5892, 5937,
        6013, 6199, 6225, 6237, 6329, 6534, 6611, 6780, 6756, 6861, 7017, 7082, 7103, 7104, 7395, 7417, 7535, 7497, 7746, 7669, 7847,
        7979, 8169, 8279, 8404, 8188, 8300, 8387, 8550, 8662, 8705, 8716, 8886, 9142, 8975, 9343]
    const n1000 = [98, 195, 293, 389, 485, 581, 679, 771, 871, 965, 1045, 1151, 1239, 1350, 1451, 1543, 1640, 1704, 1797, 1922, 2030,
        2099, 2191, 2306, 2389, 2503, 2533, 2632, 2785, 2850, 2957, 2964, 3054, 3203, 3331, 3398, 3392, 3489, 3633, 3709, 3762, 3930,
        4069, 4091, 4099, 4241, 4436, 4530, 4458, 4605, 4730, 4832, 4883, 4885, 5025, 5236, 5209, 5281, 5507, 5497, 5597, 5571, 5849,
        5991, 5944, 6036, 6016, 6069, 6222, 6384, 6382, 6654, 6713, 6696, 6858, 6902, 7042, 7038, 7193, 7250, 7333, 7250, 7531, 7548,
        7652, 7658, 7915, 7960, 8084, 8377, 8272, 8521, 8199, 8466, 8440, 8882, 8641, 8870, 8841]
    const n10000 = [98, 195, 291, 387, 483, 578, 675, 774, 855, 966, 1060, 1151, 1250, 1273, 1447, 1520, 1632, 1710, 1827, 1862, 1879,
        2048, 2118, 2315, 2391, 2312, 2470, 2651, 2658, 2844, 2879, 2840, 2962, 3086, 3076, 3380, 3465, 3608, 3426, 3564, 3658, 3866,
        3896, 3945, 4058, 3984, 4067, 4194, 4201, 4524, 4632, 4538, 4640, 4610, 4752, 4930, 5027, 5107, 5256, 5097, 5247, 5295, 5512,
        5546, 5674, 5677, 5864, 5916, 5960, 6063, 6019, 6127, 6152, 6368, 6329, 6535, 6638, 6750, 6836, 6850, 7268, 7148, 6980, 7066,
        7162, 7307, 7317, 7533, 7526, 7620, 7892, 7768, 8012, 8042, 8053, 8173, 8211, 8309, 8306]

    const data = getData(n10, n100, n1000, n10000);

    let layout = {
        title: "Great gradient",
        showlegend: true,
        hovermode: 'closest',
        bargap: 0,
    };

    Plotly.newPlot(great, data, layout);
}

export function drawConjugateGradient() {
    const n10 = [3, 8, 6, 8, 6, 7, 155, 166, 161, 198, 227, 181, 246, 265, 378, 318, 268, 307, 338, 368, 287, 427, 398, 429,
        561, 611, 848, 949, 519, 493, 531, 421, 511, 611, 648, 871, 665, 504, 547, 377, 591, 971, 522, 701, 659, 844, 802, 781,
        909, 887, 721, 877, 910, 1171, 669, 843, 909, 551, 232, 1079, 472, 1319, 878, 117, 1120, 1412, 1161, 1142, 906, 1244, 1121,
        1198, 1183, 1585, 1300, 579, 665, 829, 684, 445, 232, 345, 471, 1382, 1311, 1092, 1210, 1261, 1872, 1605, 1545, 1531,
        1235, 1651, 1620, 1677, 1451, 1929, 1780]
    const n100 = [37, 62, 82, 101, 99, 113, 145, 142, 156, 156, 154, 167, 184, 210, 175, 193, 244, 220, 257, 242, 249, 240, 245, 250,
        248, 246, 262, 260, 270, 276, 287, 281, 285, 300, 289, 297, 354, 317, 325, 329, 331, 337, 349, 338, 341, 354, 353, 357, 356,
        375, 346, 364, 387, 370, 387, 92, 372, 392, 391, 389, 453, 396, 443, 417, 431, 423, 454, 438, 442, 457, 464, 462, 463, 482, 457,
        435, 457, 469, 474, 490, 487, 480, 484, 489, 492, 501, 503, 523, 501, 501, 530, 521, 531, 535, 520, 499, 531, 534, 551]
    const n1000 = [36, 52, 94, 87, 138, 166, 160, 189, 192, 197, 214, 235, 236, 243, 297, 240, 260, 365, 295, 318, 312, 340, 353, 370,
        292, 290, 262, 313, 317, 308, 374, 295, 305, 414, 349, 459, 85, 354, 599, 391, 388, 448, 354, 74, 1084, 536, 393, 434, 409, 391,
        396, 102, 428, 64, 425, 508, 430, 443, 443, 84, 500, 425, 446, 466, 507, 508, 452, 574, 477, 492, 451, 489, 84, 484, 484, 507,
        467, 504, 483, 492, 516, 518, 490, 516, 479, 95, 65, 534, 506, 541, 84, 548, 89, 68, 545, 135, 585, 555, 529]
    const n10000 = [39, 66, 92, 106, 111, 141, 158, 189, 214, 231, 256, 271, 346, 396, 419, 352, 615, 601, 423, 534, 645, 644, 534, 654,
        632, 683, 652, 682, 642, 752, 652, 701, 732, 762, 742, 625, 750, 754, 761, 740, 728, 760, 746, 780, 803, 840, 859, 843, 843, 861,
        856, 833, 854, 854, 854, 876, 846, 867, 866, 765, 546, 866, 854, 876, 867, 756, 978, 824, 865, 934, 954, 1063, 923, 1234, 1123, 1421,
        1142, 1341, 1234, 1443, 1343, 1428, 1582, 1843, 1942, 1754, 1834, 1867, 1934, 1834, 1934, 2134, 2129, 2317, 2343, 2432, 2531, 2531, 2456]

    const data = getData(n10, n100, n1000, n10000);

    let layout = {
        title: "Conjugate gradient",
        showlegend: true,
        hovermode: 'closest',
        bargap: 0,
    };

    Plotly.newPlot(conjugate, data, layout);
}

function getData(n10, n100, n1000, n10000) {
    const x = Array.from({length: 100}, (_, ind) => ind * 10);
    let trace1 = {
        x: x,
        y: n10,
        mode: 'lines+markers',
        name: "n = 10",
        marker: {
            color: 'rgb(219, 64, 82)',
            size: 3
        }
    };

    let trace2 = {
        x: x,
        y: n100,
        mode: 'lines+markers',
        name: "n = 100",
        marker: {
            color: 'rgb(119, 64, 82)',
            size: 3
        }
    };

    let trace3 = {
        x: x,
        y: n1000,
        mode: 'lines+markers',
        name: "n = 1000",
        marker: {
            color: 'rgb(119, 164, 42)',
            size: 3
        }
    };

    let trace4 = {
        x: x,
        y: n10000,
        mode: 'lines+markers',
        name: "n = 10000",
        marker: {
            color: 'rgb(19, 64, 142)',
            size: 3
        }
    };

    return [trace1, trace2, trace3, trace4];
}